---
title: Windows Forms DataGridView 컨트롤에서 Just-In-Time 데이터 로드를 사용하여 가상 모드 구현
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- examples [Windows Forms], just-in-time data loading
- data [Windows Forms], managing large data sets
- DataGridView control [Windows Forms], virtual mode
- just-in-time data loading
- DataGridView control [Windows Forms], large data sets
- virtual mode [Windows Forms], just-in-time data loading
ms.assetid: c2a052b9-423c-4ff7-91dc-d8c7c79345f6
ms.openlocfilehash: c8290fe7722dba564bf5addab662a9f6b62d924f
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 01/23/2019
ms.locfileid: "54607883"
---
# <a name="implementing-virtual-mode-with-just-in-time-data-loading-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="ae45a-102">Windows Forms DataGridView 컨트롤에서 Just-In-Time 데이터 로드를 사용하여 가상 모드 구현</span><span class="sxs-lookup"><span data-stu-id="ae45a-102">Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="ae45a-103">가상 모드 구현 하는 이유는 <xref:System.Windows.Forms.DataGridView> 컨트롤 필요할 때에 데이터를 검색 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-103">One reason to implement virtual mode in the <xref:System.Windows.Forms.DataGridView> control is to retrieve data only as it is needed.</span></span> <span data-ttu-id="ae45a-104">이 이라고 *-just-in-time 데이터 로드*합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-104">This is called *just-in-time data loading*.</span></span>  
  
 <span data-ttu-id="ae45a-105">원격 데이터베이스에서 매우 큰 테이블을 사용 하는 경우 예를 들어 좋습니다 표시 하기 위해 필요한 데이터를 검색 하 고 사용자가 새 행을 뷰로 스크롤할 경우에 추가 데이터를 검색 하 여 시작 지연 되지 않도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-105">If you are working with a very large table in a remote database, for example, you might want to avoid startup delays by retrieving only the data that is necessary for display and retrieving additional data only when the user scrolls new rows into view.</span></span> <span data-ttu-id="ae45a-106">응용 프로그램을 실행 하는 클라이언트 컴퓨터 데이터를 저장 하는 데 사용 가능한 메모리 양이 제한 되어 있으면 데이터베이스에서 새 값을 검색할 때 사용 되지 않는 데이터를 삭제할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-106">If the client computers running your application have a limited amount of memory available for storing data, you might also want to discard unused data when retrieving new values from the database.</span></span>  
  
 <span data-ttu-id="ae45a-107">다음 섹션을 사용 하는 방법에 설명 된 <xref:System.Windows.Forms.DataGridView> 적시에 캐시를 사용 하 여 컨트롤입니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-107">The following sections describe how to use a <xref:System.Windows.Forms.DataGridView> control with a just-in-time cache.</span></span>  
  
 <span data-ttu-id="ae45a-108">참조를 단일 목록으로이 항목의 코드를 복사할 [방법: Forms DataGridView 컨트롤의 Windows에서-Just-in-time 데이터 로드를 사용 하 여 가상 모드 구현](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-108">To copy the code in this topic as a single listing, see [How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md).</span></span>  
  
## <a name="the-form"></a><span data-ttu-id="ae45a-109">폼</span><span class="sxs-lookup"><span data-stu-id="ae45a-109">The Form</span></span>  
 <span data-ttu-id="ae45a-110">다음 코드 예제에서는 정의 읽기 전용을 포함 하는 폼 <xref:System.Windows.Forms.DataGridView> 상호 작용 하는 컨트롤을 `Cache` 개체를 통해를 <xref:System.Windows.Forms.DataGridView.CellValueNeeded> 이벤트 처리기입니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-110">The following code example defines a form containing a read-only <xref:System.Windows.Forms.DataGridView> control that interacts with a `Cache` object through a <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event handler.</span></span> <span data-ttu-id="ae45a-111">`Cache` 개체는 로컬에 저장 된 값을 관리 하 고 사용 하는 `DataRetriever` Northwind 샘플 데이터베이스의 Orders 테이블에서 값을 검색 하는 개체입니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-111">The `Cache` object manages the locally stored values and uses a `DataRetriever` object to retrieve values from the Orders table of the sample Northwind database.</span></span> <span data-ttu-id="ae45a-112">`DataRetriever` 구현 하는 개체를 `IDataPageRetriever` 에 필요한 인터페이스는 `Cache` 클래스를 초기화 하는 또한는 <xref:System.Windows.Forms.DataGridView> 행과 열을 제어 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-112">The `DataRetriever` object, which implements the `IDataPageRetriever` interface required by the `Cache` class, is also used to initialize the <xref:System.Windows.Forms.DataGridView> control rows and columns.</span></span>  
  
 <span data-ttu-id="ae45a-113">합니다 `IDataPageRetriever`, `DataRetriever`, 및 `Cache` 형식은이 항목의 뒷부분에 설명 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-113">The `IDataPageRetriever`, `DataRetriever`, and `Cache` types are described later in this topic.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ae45a-114">암호와 같은 중요한 정보를 연결 문자열 내에 저장하면 애플리케이션 보안 문제가 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-114">Storing sensitive information, such as a password, within the connection string can affect the security of your application.</span></span> <span data-ttu-id="ae45a-115">데이터베이스 액세스를 제어할 경우에는 통합 보안이라고도 하는 Windows 인증을 사용하는 방법이 더 안전합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-115">Using Windows Authentication (also known as integrated security) is a more secure way to control access to a database.</span></span> <span data-ttu-id="ae45a-116">자세한 내용은 [연결 정보 보호](../../../../docs/framework/data/adonet/protecting-connection-information.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="ae45a-116">For more information, see [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md).</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#100](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#100)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#100](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#100)]  
  
## <a name="the-idatapageretriever-interface"></a><span data-ttu-id="ae45a-117">IDataPageRetriever 인터페이스</span><span class="sxs-lookup"><span data-stu-id="ae45a-117">The IDataPageRetriever Interface</span></span>  
 <span data-ttu-id="ae45a-118">다음 코드 예제에서는 정의 `IDataPageRetriever` 에서 구현 하는 인터페이스를 `DataRetriever` 클래스입니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-118">The following code example defines the `IDataPageRetriever` interface, which is implemented by the `DataRetriever` class.</span></span> <span data-ttu-id="ae45a-119">이 인터페이스에서 선언 된 유일한 메서드는는 `SupplyPageOfData` 메서드는 초기 행 인덱스 및 데이터의 단일 페이지에 있는 행의 수가 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-119">The only method declared in this interface is the `SupplyPageOfData` method, which requires an initial row index and a count of the number of rows in a single page of data.</span></span> <span data-ttu-id="ae45a-120">이러한 값은 데이터 원본에서 데이터의 하위 집합을 검색 구현자에 의해 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-120">These values are used by the implementer to retrieve a subset of data from a data source.</span></span>  
  
 <span data-ttu-id="ae45a-121">`Cache` 개체 데이터의 첫 두 페이지가 로드 생성 하는 동안이 인터페이스의 구현을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-121">A `Cache` object uses an implementation of this interface during construction to load two initial pages of data.</span></span> <span data-ttu-id="ae45a-122">캐시 되지 않은 값을 필요할 때마다 캐시 이러한 페이지 중 하나를 삭제 하 고에서 값이 포함 된 새 페이지를 요청 합니다 `IDataPageRetriever`합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-122">Whenever an uncached value is needed, the cache discards one of these pages and requests a new page containing the value from the `IDataPageRetriever`.</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#201](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#201)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#201](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#201)]  
  
## <a name="the-dataretriever-class"></a><span data-ttu-id="ae45a-123">DataRetriever 클래스</span><span class="sxs-lookup"><span data-stu-id="ae45a-123">The DataRetriever Class</span></span>  
 <span data-ttu-id="ae45a-124">다음 코드 예제에서는 정의 `DataRetriever` 클래스를 구현 하는 `IDataPageRetriever` 서버에서 데이터 페이지를 검색 하는 인터페이스입니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-124">The following code example defines the `DataRetriever` class, which implements the `IDataPageRetriever` interface to retrieve pages of data from a server.</span></span> <span data-ttu-id="ae45a-125">`DataRetriever` 클래스도 제공 `Columns` 및 `RowCount` 속성을는 합니다 <xref:System.Windows.Forms.DataGridView> 제어 사용 하 여 필요한 열을 만드는 빈 행의 적절 한 수를 추가 하는 <xref:System.Windows.Forms.DataGridView.Rows%2A> 컬렉션입니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-125">The `DataRetriever` class also provides `Columns` and `RowCount` properties, which the <xref:System.Windows.Forms.DataGridView> control uses to create the necessary columns and to add the appropriate number of empty rows to the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection.</span></span> <span data-ttu-id="ae45a-126">빈 행을 추가 하는 데 필요 컨트롤은 테이블의 모든 데이터를 포함 하는 것 처럼 동작 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-126">Adding the empty rows is necessary so that the control will behave as though it contains all the data in the table.</span></span> <span data-ttu-id="ae45a-127">즉, 스크롤 막대의 스크롤 상자에 적절 한 크기를 해야 합니다. 사용자 테이블의 모든 행에 액세스할 수 없게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-127">This means that the scroll box in the scroll bar will have the appropriate size, and the user will be able to access any row in the table.</span></span> <span data-ttu-id="ae45a-128">행으로 채워질는 <xref:System.Windows.Forms.DataGridView.CellValueNeeded> 뷰로 스크롤할 때에 이벤트 처리기입니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-128">The rows are filled by the <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event handler only when they are scrolled into view.</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#200](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#200)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#200](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#200)]  
  
## <a name="the-cache-class"></a><span data-ttu-id="ae45a-129">캐시 클래스</span><span class="sxs-lookup"><span data-stu-id="ae45a-129">The Cache Class</span></span>  
 <span data-ttu-id="ae45a-130">다음 코드 예제에서는 정의 `Cache` 를 통해 입력 데이터의 두 페이지를 관리 하는 클래스는 `IDataPageRetriever` 구현 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-130">The following code example defines the `Cache` class, which manages two pages of data populated through an `IDataPageRetriever` implementation.</span></span> <span data-ttu-id="ae45a-131">`Cache` 클래스 정의 내부 `DataPage` 포함 된 구조를 <xref:System.Data.DataTable> 페이지 및 행 인덱스를 계산 하는 나타내는 페이지의 상한 및 하 한 경계 값을 단일 캐시에 저장 하 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-131">The `Cache` class defines an inner `DataPage` structure, which contains a <xref:System.Data.DataTable> to store the values in a single cache page and which calculates the row indexes that represent the upper and lower boundaries of the page.</span></span>  
  
 <span data-ttu-id="ae45a-132">`Cache` 클래스 생성 시 데이터의 두 페이지를 로드 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-132">The `Cache` class loads two pages of data at construction time.</span></span> <span data-ttu-id="ae45a-133">때마다 합니다 <xref:System.Windows.Forms.DataGridView.CellValueNeeded> 값을 요청 하는 이벤트를 `Cache` 개체 값에 표시 되 면 두 가지 페이지 및 결정, 그렇다면 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-133">Whenever the <xref:System.Windows.Forms.DataGridView.CellValueNeeded> event requests a value, the `Cache` object determines if the value is available in one of its two pages and, if so, returns it.</span></span> <span data-ttu-id="ae45a-134">값을 로컬에서 사용할 수 없는 경우는 `Cache` 개체 결정 두 페이지의 현재 표시 된 행에서 가장 먼 이며 그런 다음 반환 하는 요청 된 값이 포함 된 새 리소스를 사용 하 여 페이지를 대체 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-134">If the value is not available locally, the `Cache` object determines which of its two pages is farthest from the currently displayed rows and replaces the page with a new one containing the requested value, which it then returns.</span></span>  
  
 <span data-ttu-id="ae45a-135">데이터 페이지의 행 수가 한 번에 화면에 표시 될 수 있는 행의 수와 동일 인을 만든다고 가정이 모델에는 테이블을 통해 페이징 사용자를 게 가장 최근에 열어 본 페이지를 효율적으로 반환할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-135">Assuming that the number of rows in a data page is the same as the number of rows that can be displayed on screen at once, this model allows users paging through the table to efficiently return to the most recently viewed page.</span></span>  
  
 [!code-csharp[System.Windows.Forms.DataGridView.Virtual_lazyloading#300](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/CS/lazyloading.cs#300)]
 [!code-vb[System.Windows.Forms.DataGridView.Virtual_lazyloading#300](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridView.Virtual_lazyloading/VB/lazyloading.vb#300)]  
  
## <a name="additional-considerations"></a><span data-ttu-id="ae45a-136">추가 고려 사항</span><span class="sxs-lookup"><span data-stu-id="ae45a-136">Additional Considerations</span></span>  
 <span data-ttu-id="ae45a-137">이전 코드 예제에서는-just-in-time 데이터 로드의 데모로 제공 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-137">The previous code examples are provided as a demonstration of just-in-time data loading.</span></span> <span data-ttu-id="ae45a-138">효율성을 극대화 하기 위해 고유의 요구 사항에 대 한 코드를 수정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-138">You will need to modify the code for your own needs to achieve maximum efficiency.</span></span> <span data-ttu-id="ae45a-139">최소한, 캐시에 데이터 페이지당 행 수에 대 한 적절 한 값을 선택 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-139">At minimum, you will need to choose an appropriate value for the number of rows per page of data in the cache.</span></span> <span data-ttu-id="ae45a-140">이 값에 전달 되는 `Cache` 생성자입니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-140">This value is passed into the `Cache` constructor.</span></span> <span data-ttu-id="ae45a-141">페이지당 행 수는 같거나 더 높아야 동시에 표시 될 수 있는 행의 수에 <xref:System.Windows.Forms.DataGridView> 제어 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-141">The number of rows per page should be no less than the number of rows that can be displayed simultaneously in your <xref:System.Windows.Forms.DataGridView> control.</span></span>  
  
 <span data-ttu-id="ae45a-142">최상의 결과 위해 성능 테스트 및 사용 편의성 테스트 시스템 및 사용자의 요구 사항을 확인 하려면 수행 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-142">For best results, you will need to conduct performance testing and usability testing to determine the requirements of your system and your users.</span></span> <span data-ttu-id="ae45a-143">고려해 야 할 여러 요인이 응용 프로그램, 사용, 네트워크 연결의 사용 가능한 대역폭 및 대기 시간 사용 하는 서버를 실행 하는 클라이언트 컴퓨터에 메모리의 양을 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-143">Several factors that you will need to take into consideration include the amount of memory in the client machines running your application, the available bandwidth of the network connection used, and the latency of the server used.</span></span> <span data-ttu-id="ae45a-144">대역폭 및 대기 시간에 최대 사용량의 결정 되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-144">The bandwidth and latency should be determined at times of peak usage.</span></span>  
  
 <span data-ttu-id="ae45a-145">응용 프로그램의 스크롤 성능 향상을 위해 로컬로 저장 된 데이터의 크기를 늘릴 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-145">To improve the scrolling performance of your application, you can increase the amount of data stored locally.</span></span> <span data-ttu-id="ae45a-146">그러나 시작 시간을 향상 시키려면 하지 않도록 해야 처음에 너무 많은 데이터를 로드 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-146">To improve startup time, however, you must avoid loading too much data initially.</span></span> <span data-ttu-id="ae45a-147">수정 하려는 경우는 `Cache` 클래스를 저장할 수 있는 데이터 페이지 수를 늘립니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-147">You may want to modify the `Cache` class to increase the number of data pages it can store.</span></span> <span data-ttu-id="ae45a-148">더 많은 데이터 페이지를 사용 하 여 스크롤의 효율성을 향상 시킬 수 있지만 서버 대기 시간 및 사용 가능한 대역폭에 따라 데이터 페이지에서 행의 이상적인 개수를 확인 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-148">Using more data pages can improve scrolling efficiency, but you will need to determine the ideal number of rows in a data page, depending on the available bandwidth and the server latency.</span></span> <span data-ttu-id="ae45a-149">더 작은 페이지를 사용 하 여 서버에 자주 액세스 하지만 요청 된 데이터를 반환 하는 시간이 적게 걸립니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-149">With smaller pages, the server will be accessed more frequently, but will take less time to return the requested data.</span></span> <span data-ttu-id="ae45a-150">대기 시간 보다 대역폭 문제에 대 한 자세한 내용은 인 경우에 더 큰 데이터 페이지를 사용 하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="ae45a-150">If latency is more of an issue than bandwidth, you may want to use larger data pages.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ae45a-151">참고자료</span><span class="sxs-lookup"><span data-stu-id="ae45a-151">See also</span></span>
- <xref:System.Windows.Forms.DataGridView>
- <xref:System.Windows.Forms.DataGridView.VirtualMode%2A>
- [<span data-ttu-id="ae45a-152">Windows Forms DataGridView 컨트롤의 성능 조정</span><span class="sxs-lookup"><span data-stu-id="ae45a-152">Performance Tuning in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/performance-tuning-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="ae45a-153">Windows Forms DataGridView 컨트롤의 크기를 조정하는 최선의 방법</span><span class="sxs-lookup"><span data-stu-id="ae45a-153">Best Practices for Scaling the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/best-practices-for-scaling-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="ae45a-154">Windows Forms DataGridView 컨트롤의 가상 모드</span><span class="sxs-lookup"><span data-stu-id="ae45a-154">Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="ae45a-155">연습: Windows Forms DataGridView 컨트롤에서 가상 모드 구현</span><span class="sxs-lookup"><span data-stu-id="ae45a-155">Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md)
- [<span data-ttu-id="ae45a-156">방법: Windows Forms DataGridView 컨트롤에서-Just-in-time 데이터 로드를 사용 하 여 가상 모드 구현</span><span class="sxs-lookup"><span data-stu-id="ae45a-156">How to: Implement Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/virtual-mode-with-just-in-time-data-loading-in-the-datagrid.md)
